{"id": "03342e33-fd78-47d2-9111-7f81119ca83f", "type": "dataset", "server": "https://api.resourcewatch.org", "attributes": {"name": "Predefined weights layers", "slug": "Predefined-weights-layers_1", "type": null, "subtitle": null, "application": ["aqueduct-water-risk"], "dataPath": null, "attributesPath": null, "connectorType": "rest", "provider": "cartodb", "userId": "5936af3802d342203186ab99", "connectorUrl": "https://wri-rw.carto.com/tables/water_risk_indicators_annual/public", "sources": [], "tableName": "water_risk_indicators_annual", "status": "saved", "published": true, "overwrite": false, "verified": false, "blockchain": {}, "mainDateField": null, "env": "production", "geoInfo": false, "protected": false, "legend": {"date": [], "region": [], "country": [], "nested": [], "integer": [], "short": [], "byte": [], "double": [], "float": [], "half_float": [], "scaled_float": [], "boolean": [], "binary": [], "text": [], "keyword": []}, "clonedHost": {}, "errorMessage": "", "taskId": null, "createdAt": "2019-10-10T12:15:47.295Z", "updatedAt": "2019-10-10T12:15:49.547Z", "dataLastUpdated": null, "metadata": [], "widget": [], "layer": [{"id": "574d1058-7338-42aa-a27e-bb449eb86da3", "type": "layer", "attributes": {"name": "Predefined weights layers", "slug": "Predefined-weights-layers_1", "dataset": "03342e33-fd78-47d2-9111-7f81119ca83f", "description": "", "application": ["aqueduct-water-risk"], "iso": [], "provider": "cartodb", "userId": "5936af3802d342203186ab99", "default": false, "protected": false, "published": true, "env": "production", "layerConfig": {"sql_config": [], "params_config": [{"required": true, "key": "indicator"}, {"required": true, "key": "label"}, {"required": true, "key": "fraction"}], "body": {"layers": [{"options": {"cartocss_version": "2.3.0", "cartocss": "#water_risk_indicators_annual{ polygon-fill:transparent; polygon-opacity: 1; line-color:transparent; line-width: 1; line-opacity: 1; } #water_risk_indicators_annual [water_risk=4] { polygon-fill:#990000; line-color:#990000 } #water_risk_indicators_annual [water_risk=3] { polygon-fill:  #FF1900; line-color:  #FF1900 } #water_risk_indicators_annual [water_risk=2] { polygon-fill: #FF9900; line-color: #FF9900 } #water_risk_indicators_annual [water_risk=1] { polygon-fill: #FFE600; line-color:  #FFE600 } #water_risk_indicators_annual [water_risk=0] { polygon-fill: #FFFF99; line-color:  #FFFF99 } #water_risk_indicators_annual [water_risk=-1] { polygon-fill: #808080; line-color:  #808080 } #water_risk_indicators_annual [water_risk<-1] { polygon-fill: #4E4E4E; line-color:  #4E4E4E }", "sql": "with r as (SELECT s.aq30_id as cartodb_id, s.aq30_id, coalesce({{indicator}}, -9999) as  water_risk, coalesce(NULLIF({{label}},''), 'NoData') as label, {{fraction}} as fraction, r.the_geom_webmercator, r.the_geom FROM water_risk_indicators_annual s LEFT JOIN y2018m12d06_rh_master_shape_v01 r on s.aq30_id=r.aq30_id WHERE w_awr_def_tot_cat is not null and s.pfaf_id != -9999 and s.gid_1 != '-9999' and r.aqid != -9999) SELECT cartodb_id, aq30_id, r.the_geom_webmercator, r.the_geom, CASE WHEN water_risk = 4 and  fraction > 0.75 THEN 4 WHEN water_risk = 3 and  fraction > 0.75 THEN 3 WHEN water_risk = 2 and  fraction > 0.75 THEN 2 WHEN water_risk = 1 and  fraction > 0.75 THEN 1 WHEN water_risk = 0 and  fraction > 0.75 THEN 0 WHEN water_risk = -1 and  fraction > 0.75 THEN -1 ELSE  -9999 END as water_risk, CASE WHEN label = 'Extremely High (4-5)' and  fraction > 0.75 THEN 'Extremely High (4-5)' WHEN label = 'High (3-4)' and  fraction > 0.75 THEN 'High (3-4)' WHEN label = 'Medium - High (2-3)' and  fraction > 0.75 THEN 'Medium - High (2-3)' WHEN label = 'Low - Medium (1-2)' and  fraction > 0.75 THEN 'Low - Medium (1-2)' WHEN label = 'Low (0-1)' and  fraction > 0.75 THEN 'Low (0-1)' WHEN label = 'No Data' and  fraction > 0.75 THEN 'No Data' ELSE  'No Data' END as label FROM r"}, "type": "cartodb"}]}, "account": "wri-rw"}, "legendConfig": {"type": "choropleth", "items": [{"value": "(>80%)", "name": "Extremely high", "color": "#990000"}, {"value": "(40-80%)", "name": "High", "color": "#FF1900"}, {"value": "(20-40%)", "name": "Medium to high", "color": "#FF9900"}, {"value": "(10-20%)", "name": "Low to medium", "color": "#FFE600"}, {"value": "(<10%)", "name": "Low", "color": "#FFFF99"}, {"name": "Arid & low water use", "color": "#808080"}, {"name": "No data", "color": "#4E4E4E"}]}, "interactionConfig": {"output": [{"column": "label", "format": null, "prefix": "", "property": "Category", "suffix": "", "type": "string"}]}, "applicationConfig": {}, "staticImageConfig": {}, "createdAt": "2019-10-10T12:15:59.490Z", "updatedAt": "2019-10-10T12:15:59.490Z"}}], "vocabulary": [], "widgetRelevantProps": [], "layerRelevantProps": []}}